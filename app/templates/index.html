<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>æ¼‚æµãƒœãƒˆãƒ«</title>
</head>
<body style="font-family: system-ui; max-width: 720px; margin: 40px auto; line-height: 1.6;">
  <h1>ğŸŒŠ æ¼‚æµãƒœãƒˆãƒ«</h1>

  <section style="padding: 12px; border: 1px solid #ddd; border-radius: 12px; margin-bottom: 16px;">
    <h2>ã¯ã˜ã‚ã¦ã®äºº</h2>
    <form action="/anon" method="post">
      <label>ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ </label><br/>
      <input name="nickname" maxlength="32" style="width: 100%; padding: 8px; margin: 6px 0 10px;" />
      <button type="submit" style="padding: 10px 14px;">æµ·ã«å…¥ã‚‹</button>
    </form>
    <p style="color:#666;">â€»ç™»éŒ²ãªã—ã€‚Cookieã«åŒ¿åIDã‚’ä¿å­˜ã—ã¦ã€æ¯æ—¥1é€šã ã‘å±Šãã€‚</p>
  </section>

  <section style="padding: 12px; border: 1px solid #ddd; border-radius: 12px; margin-bottom: 16px;">
    <h2>ä»Šæ—¥ã®ãƒœãƒˆãƒ«</h2>
    <button onclick="loadToday()" style="padding: 10px 14px;">å—ã‘å–ã‚‹</button>
    <pre id="today" style="white-space: pre-wrap; background:#fafafa; padding: 12px; border-radius: 10px; margin-top: 10px;"></pre>
  </section>

  <section style="padding: 12px; border: 1px solid #ddd; border-radius: 12px;">
    <h2>ãƒœãƒˆãƒ«ã‚’æµã™</h2>
    <form action="/bottles" method="post">
      <textarea name="content" maxlength="2000" rows="6" style="width: 100%; padding: 10px;"></textarea><br/>
      <button type="submit" style="padding: 10px 14px; margin-top: 8px;">æµã™</button>
    </form>
  </section>

<script>
async function loadToday() {
  const el = document.getElementById("today");
  el.textContent = "â€¦â€¦æ¼‚æµä¸­";
  const res = await fetch("/today");
  const data = await res.json();
  if (data.bottle && data.bottle.content) {
    el.textContent = data.bottle.content + "\n\n( bottle_id: " + data.bottle.id + " )";
  } else {
    el.textContent = data.message || "ä»Šæ—¥ã¯ã¾ã å±Šã‹ãªã„ã€‚";
  }
}
</script>
</body>
</html>
